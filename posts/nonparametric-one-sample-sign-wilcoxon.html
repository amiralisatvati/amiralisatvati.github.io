<!DOCTYPE html>
<html lang="fa" dir="rtl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دانشنامه جامع آمار ناپارامتری</title>
    
    <!-- کتابخانه‌های ضروری -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- تنظیمات تم -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e3a8a',   // سرمه‌ای تیره
                        secondary: '#3b82f6', // آبی روشن
                        accent: '#f59e0b',    // نارنجی/طلایی
                        bg: '#f3f4f6'         // خاکستری خیلی روشن
                    },
                    fontFamily: {
                        sans: ['Vazirmatn', 'Tahoma', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css');
        
        body { font-family: 'Vazirmatn', sans-serif; background-color: #f3f4f6; }
        
        .glass-header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .content-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s;
        }

        .content-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .formula-box {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            color: #e2e8f0;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin: 1.5rem 0;
            position: relative;
            overflow: hidden;
            border: 1px solid #334155;
        }

        /* استایل جداول */
        .custom-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 0.75rem;
            overflow: hidden;
            margin: 1.5rem 0;
            border: 1px solid #e5e7eb;
        }
        .custom-table th {
            background-color: #1e3a8a;
            color: white;
            padding: 1rem;
            font-weight: 600;
        }
        .custom-table td {
            background-color: white;
            padding: 1rem;
            border-bottom: 1px solid #e5e7eb;
            text-align: center;
        }
        .custom-table tr:last-child td { border-bottom: none; }
        .custom-table tr:nth-child(even) td { background-color: #f8fafc; }
        .custom-table tr:hover td { background-color: #eff6ff; }

        /* نوار کناری */
        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: #4b5563;
            border-radius: 0.5rem;
            transition: all 0.2s;
            margin-bottom: 0.5rem;
        }
        .sidebar-link:hover, .sidebar-link.active {
            background-color: #eff6ff;
            color: #1d4ed8;
            font-weight: 600;
        }
        .sidebar-link i { margin-left: 0.75rem; width: 20px; text-align: center; }

        /* چت بات */
        #chat-widget {
            position: fixed;
            bottom: 90px;
            left: 20px;
            width: 350px;
            height: 450px;
            background: white;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            display: none;
            flex-direction: column;
            z-index: 50;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }
        .chat-header {
            background: #1e3a8a;
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
            background: #f9fafb;
        }
        .message {
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            border-radius: 0.75rem;
            max-width: 80%;
            font-size: 0.9rem;
        }
        .message.bot { background: #e0f2fe; color: #0c4a6e; border-bottom-right-radius: 0; margin-left: auto; }
        .message.user { background: #1e3a8a; color: white; border-bottom-left-radius: 0; margin-right: auto; }
    </style>
</head>
<body class="text-gray-800">

    <!-- نوار ناوبری -->
    <nav class="fixed top-0 w-full glass-header z-40 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-3">
                    <div class="bg-blue-900 text-white p-2 rounded-lg">
                        <i class="fas fa-chart-line text-xl"></i>
                    </div>
                    <span class="font-bold text-xl text-blue-900">آمار ناپارامتری</span>
                </div>
                <div class="hidden md:flex gap-6 text-gray-600 text-sm font-medium">
                    <a href="#intro" class="hover:text-blue-700 transition">مبانی</a>
                    <a href="#wilcoxon" class="hover:text-blue-700 transition">ویلکاکسون مستقل</a>
                    <a href="#signtest" class="hover:text-blue-700 transition">آزمون علامت</a>
                    <a href="#paired" class="hover:text-blue-700 transition">داده‌های جفتی</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- محتوای اصلی -->
    <main class="max-w-7xl mx-auto px-4 pt-24 pb-12 grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <!-- سایدبار (چپ) -->
        <aside class="hidden lg:block lg:col-span-3">
            <div class="sticky top-24 content-card p-4">
                <div class="text-xs font-bold text-gray-400 uppercase mb-4 px-2">فهرست مطالب</div>
                <nav id="toc">
                    <a href="#intro" class="sidebar-link active">
                        <i class="fas fa-info-circle"></i> مبانی و چرایی
                    </a>
                    <a href="#wilcoxon" class="sidebar-link">
                        <i class="fas fa-project-diagram"></i> ویلکاکسون (مستقل)
                    </a>
                    <a href="#signtest" class="sidebar-link">
                        <i class="fas fa-plus-minus"></i> آزمون علامت
                    </a>
                    <a href="#paired" class="sidebar-link">
                        <i class="fas fa-user-friends"></i> داده‌های جفتی
                    </a>
                    <a href="#advanced" class="sidebar-link">
                        <i class="fas fa-graduation-cap"></i> نکات کنکوری
                    </a>
                </nav>
            </div>
        </aside>

        <!-- ستون وسط (متن) -->
        <div class="lg:col-span-9 space-y-8">
            
            <!-- هدر صفحه -->
            <div class="text-center mb-10">
                <h1 class="text-4xl font-extrabold text-blue-900 mb-4 leading-tight">
                    دانشنامه جامع آمار ناپارامتری
                </h1>
                <p class="text-gray-500 text-lg">
                    تدوین تخصصی بر اساس سرفصل‌های دانشگاهی و جزوات کلاسی
                </p>
                <div class="flex justify-center gap-2 mt-4">
                    <span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold">تألیفی</span>
                    <span class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold">نسخه ۲۰۲۶</span>
                </div>
            </div>

            <!-- بخش ۱: مقدمه -->
            <section id="intro" class="content-card p-8">
                <div class="flex items-center gap-3 mb-6 border-b pb-4">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                        <span class="font-bold text-lg">۱</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">مبانی و چرایی روش‌های ناپارامتری</h2>
                </div>
                
                <div class="bg-blue-50 border-r-4 border-blue-500 p-6 rounded-lg mb-6">
                    <p class="text-gray-700 leading-relaxed">
                        در تحلیل‌های آماری سنتی (مانند آزمون t)، فرض بر این است که جامعه آماری از توزیع نرمال پیروی می‌کند. اما در بسیاری از موارد، این فرض باطل است. دلایل استفاده از روش‌های ناپارامتری عبارتند از:
                    </p>
                    <ul class="list-disc list-inside mt-4 space-y-2 text-gray-600">
                        <li><strong>عدم نرمال بودن:</strong> زمانی که داده‌ها دارای چولگی شدید هستند.</li>
                        <li><strong>حجم نمونه کم:</strong> زمانی که تعداد داده‌ها آنقدر کم است (\(n < 30\)) که نمی‌توان از قضیه حد مرکزی استفاده کرد.</li>
                        <li><strong>داده‌های رتبه‌ای:</strong> زمانی که ماهیت داده‌ها عددی نیست (مثلاً درجه رضایت مشتری).</li>
                        <li><strong>حساسیت به داده‌های پرت:</strong> آزمون‌های پارامتری به شدت تحت تاثیر مقادیر بسیار بزرگ یا کوچک قرار می‌گیرند، در حالی که رتبه‌بندی این اثر را خنثی می‌کند.</li>
                    </ul>
                </div>
            </section>

            <!-- بخش ۲: ویلکاکسون مستقل -->
            <section id="wilcoxon" class="content-card p-8">
                <div class="flex items-center gap-3 mb-6 border-b pb-4">
                    <div class="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600">
                        <span class="font-bold text-lg">۲</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">آزمون مجموع رتبه‌های ویلکاکسون (نمونه‌های مستقل)</h2>
                </div>

                <p class="text-gray-600 mb-6">
                    این آزمون برای مقایسه "مکان" (Location) دو جامعه مستقل به کار می‌رود. یعنی می‌خواهیم بدانیم آیا میانگین/میانه دو جامعه با هم تفاوت معنی‌داری دارند یا خیر.
                </p>
                
                <h3 class="font-bold text-lg text-blue-800 mb-3">فرمول‌ها و روابط زیربنایی</h3>
                <p class="text-gray-600 mb-4">فرض کنید دو گروه \(X\) (با \(m\) عضو) و \(Y\) (با \(n\) عضو) داریم. کل مشاهدات \(N = m + n\).</p>
                
                <div class="formula-box text-center" dir="ltr">
                    <div class="mb-4">1. Sum of Ranks: \[W_R + W_S = \frac{N(N+1)}{2}\]</div>
                    <div class="mb-4">2. Expected Value (\(H_0\)): \[E(W_s) = \frac{n(N+1)}{2}\]</div>
                    <div>3. Variance: \[Var(W_s) = \frac{mn(N+1)}{12}\]</div>
                </div>

                <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-6">
                    <h4 class="font-bold text-yellow-800 mb-3"><i class="fas fa-lightbulb"></i> حل تشریحی تمرین‌های ۱ تا ۶ (تحلیل جزوه)</h4>
                    <p class="text-gray-700 mb-2"><strong>تمرین ۱ و ۲ (تحلیل جامع):</strong> اگر \(m=3\) و \(n=2\) باشد:</p>
                    <ul class="space-y-2 text-gray-600 list-none">
                        <li><i class="fas fa-check text-green-500 ml-2"></i> کل فضای نمونه: ترکیب ۲ از ۵ یعنی ۱۰ حالت ممکن برای انتخاب رتبه‌های گروه \(Y\).</li>
                        <li><i class="fas fa-check text-green-500 ml-2"></i> تکیه‌گاه آماره: کمترین مجموع رتبه‌ها \(1+2=3\) و بیشترین مجموع \(4+5=9\). پس بازه تغییرات \([3, 9]\) است.</li>
                        <li><i class="fas fa-check text-green-500 ml-2"></i> احتمال \(P(W_s=5)\): حالت‌هایی که مجموع رتبه‌شان ۵ می‌شود عبارتند از \(\{1, 4\}\) و \(\{2, 3\}\). پس احتمال برابر با \(2/10 = 0.2\).</li>
                        <li><i class="fas fa-check text-green-500 ml-2"></i> امید ریاضی: بر اساس فرمول \(E(W_s) = \frac{2(5+1)}{2} = 6\).</li>
                    </ul>
                </div>

                <div class="bg-red-50 text-red-700 px-4 py-3 rounded-lg flex items-start gap-3">
                    <i class="fas fa-exclamation-triangle mt-1"></i>
                    <div>
                        <strong>نکته امتحانی:</strong> در آزمون ویلکاکسون، رتبه‌بندی باید روی تمام \(N\) داده (ترکیب هر دو گروه) انجام شود. اگر داده‌های تکراری وجود داشته باشد، از "میانگین رتبه‌ها" استفاده می‌کنیم.
                    </div>
                </div>
            </section>

            <!-- بخش ۳: آزمون علامت -->
            <section id="signtest" class="content-card p-8">
                <div class="flex items-center gap-3 mb-6 border-b pb-4">
                    <div class="w-10 h-10 rounded-full bg-teal-100 flex items-center justify-center text-teal-600">
                        <span class="font-bold text-lg">۳</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">آزمون علامت (Sign Test) و تحلیل صدک‌ها</h2>
                </div>

                <p class="text-gray-600 mb-4">
                    این آزمون یکی از قدیمی‌ترین و ساده‌ترین آزمون‌های ناپارامتری است که فقط بر اساس جهت اختلاف داده‌ها نسبت به یک مقدار مرجع (\(\eta_0\)) کار می‌کند.
                </p>

                <h3 class="font-bold text-lg text-blue-800 mb-3">مدل ریاضی و توزیع دوجمله‌ای</h3>
                <p class="text-gray-600 mb-2">اگر بخواهیم ادعایی را درباره صدک \(p\)-ام (مانند میانه که صدک ۵۰ام است) بسنجیم:</p>
                <div class="formula-box text-center" dir="ltr">
                    \[B = \sum I(X_i > \eta_0) \sim \text{Bin}(n, 1-p)\]
                </div>
                <p class="text-gray-600 mb-6">در آزمون میانه (\(p=0.5\))، آماره \(B\) پیرو توزیع دوجمله‌ای با احتمال موفقیت \(0.5\) است.</p>

                <div class="bg-gray-50 border border-gray-200 rounded-xl p-6">
                    <h4 class="font-bold text-gray-800 mb-3">مثال کاربردی: طول عمر باتری</h4>
                    <p class="text-gray-700 mb-2">ادعا: میانه عمر باتری‌ها ۶۰ ساعت است. داده‌ها: <code class="bg-gray-200 px-2 py-1 rounded font-mono text-sm">58, 62, 65, 55, 68, 70, 61, 63, 59, 67</code></p>
                    <ul class="space-y-2 mt-4 text-gray-600 list-decimal list-inside">
                        <li><strong>تعیین علامت‌ها:</strong> داده‌های بزرگتر از ۶۰ با علامت (+) و کوچکتر با (-) مشخص می‌شوند.</li>
                        <li><strong>شمارش:</strong> ۷ عدد (+) و ۳ عدد (-). پس \(B=7\).</li>
                        <li><strong>محاسبه P-value:</strong> برای آزمون دوطرفه، احتمال این را می‌سنجیم که تحت فرض صفر، آماره به این اندازه یا بیشتر از میانگین دور شود.</li>
                        <li><strong>نتیجه:</strong> چون P-value از ۵٪ بیشتر است، ادعا رد نمی‌شود.</li>
                    </ul>
                </div>
            </section>

            <!-- بخش ۴: داده‌های جفتی -->
            <section id="paired" class="content-card p-8">
                <div class="flex items-center gap-3 mb-6 border-b pb-4">
                    <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-600">
                        <span class="font-bold text-lg">۴</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">تحلیل داده‌های جفتی (Paired Samples)</h2>
                </div>

                <p class="text-gray-600 mb-4">این بخش برای مسائلی است که در آن "یک نمونه" در "دو وضعیت متفاوت" (مثل قبل و بعد) سنجیده می‌شود.</p>

                <h3 class="font-bold text-lg text-blue-800 mt-6 mb-3">الف) آزمون علامت جفتی (مثال فشار خون)</h3>
                <p class="text-gray-600">هدف: بررسی تاثیر دارو بر فشار خون ۸ بیمار.</p>
                
                <div class="overflow-x-auto">
                    <table class="custom-table">
                        <thead>
                            <tr>
                                <th>بیمار</th><th>قبل</th><th>بعد</th><th>اختلاف (D)</th><th>علامت</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>۱</td><td>۱۵۰</td><td>۱۴۰</td><td>۱۰</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr><td>۲</td><td>۱۶۰</td><td>۱۵۸</td><td>۲</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr><td>۳</td><td>۱۵۵</td><td>۱۵۰</td><td>۵</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr><td>۴</td><td>۱۷۰</td><td>۱۶۵</td><td>۵</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr class="bg-red-50"><td>۵</td><td>۱۴۵</td><td>۱۴۵</td><td>۰</td><td class="text-red-500 font-bold">حذف</td></tr>
                            <tr><td>۶</td><td>۱۵۲</td><td>۱۴۸</td><td>۴</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr><td>۷</td><td>۱۴۸</td><td>۱۴۲</td><td>۶</td><td class="text-green-600 font-bold">+</td></tr>
                            <tr><td>۸</td><td>۱۶۲</td><td>۱۶۰</td><td>۲</td><td class="text-green-600 font-bold">+</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="bg-amber-50 text-amber-800 p-4 rounded-lg mb-4 border border-amber-200">
                    <strong>قانون حذف:</strong> در آزمون علامت، هر جفتی که اختلافش صفر باشد از محاسبات حذف می‌شود و حجم نمونه (\(n\)) کاهش می‌یابد. در اینجا \(n=7\) است.
                </div>
                <p class="text-gray-700 mb-8">
                    <span class="font-bold text-green-600">نتیجه:</span> چون هر ۷ نفر کاهش فشار داشتند، احتمال رخ دادن این اتفاق به صورت تصادفی \( (0.5)^7 = 0.0078 \) است که از ۵٪ کمتر است. پس دارو موثر است.
                </p>

                <h3 class="font-bold text-lg text-blue-800 mb-3">ب) آزمون علامت دوطرفه (نمرات کلاس تقویتی)</h3>
                <p class="text-gray-600 mb-6">اگر بخواهیم فقط "تغییر" را بسنجیم (نه لزوماً بهبود)، آزمون دوطرفه می‌شود. در مثال نمرات دانشجویان، با ۸ داده موثر، احتمال مشاهده ۷ مثبت یا بیشتر (یا ۷ منفی یا بیشتر) بررسی شد و نتیجه این بود که تغییرات در سطح ۵٪ معنی‌دار نیستند (\(P \approx 0.07\)).</p>

                <h3 class="font-bold text-lg text-blue-800 mb-3">ج) آزمون ویلکاکسون جفتی (زمان واکنش)</h3>
                <p class="text-gray-600 mb-4">این آزمون از رتبه‌بندی اختلافات استفاده می‌کند. در مثال زمان واکنش ۶ نفر:</p>
                <ul class="list-none space-y-2 text-gray-600">
                    <li><i class="fas fa-arrow-left text-blue-400 ml-2"></i> ابتدا اختلافات محاسبه شد.</li>
                    <li><i class="fas fa-arrow-left text-blue-400 ml-2"></i> قدرمطلق اختلافات از کوچک به بزرگ رتبه‌بندی شد.</li>
                    <li><i class="fas fa-arrow-left text-blue-400 ml-2"></i> مجموع رتبه‌های مثبت (\(W^+\)) و منفی (\(W^-\)) حساب شد.</li>
                    <li><i class="fas fa-arrow-left text-blue-400 ml-2"></i> آماره آزمون برابر با کمینه این دو مقدار (\(W=2\)) به دست آمد.</li>
                </ul>
            </section>

            <!-- بخش ۵: تقریب نرمال -->
            <section id="advanced" class="content-card p-8">
                <div class="flex items-center gap-3 mb-6 border-b pb-4">
                    <div class="w-10 h-10 rounded-full bg-rose-100 flex items-center justify-center text-rose-600">
                        <span class="font-bold text-lg">۵</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800">تقریب نرمال و نکات حرفه‌ای امتحان</h2>
                </div>

                <div class="bg-blue-50 p-6 rounded-lg mb-6">
                    <p class="text-gray-700 mb-4">وقتی حجم نمونه بالا می‌رود (معمولاً \(n, m > 10\))، استفاده از جداول توزیع دوجمله‌ای یا ویلکاکسون سخت می‌شود. در این حالت از تقریب نرمال با "تصحیح پیوستگی" استفاده می‌کنیم:</p>
                    <div class="text-center font-mono text-xl my-4 text-blue-900" dir="ltr">
                        \[Z = \frac{W_s - E(W_s) \pm 0.5}{\sqrt{Var(W_s)}}\]
                    </div>
                    <p class="text-sm text-blue-800"><strong>قانون ۰.۵ واحد:</strong> اگر آماره مشاهده شده از امید ریاضی بزرگتر بود، از آن ۰.۵ کم می‌کنیم و اگر کوچکتر بود، به آن ۰.۵ اضافه می‌کنیم.</p>
                </div>

                <h3 class="font-bold text-lg text-gray-800 mb-4">استراتژی‌های طلایی برای حل مسئله</h3>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-white border p-4 rounded-lg shadow-sm">
                        <div class="font-bold text-blue-600 mb-2">۱. فرض‌ها</div>
                        <p class="text-sm text-gray-600">همیشه اول فرض صفر و مقابل را بنویسید (نمره دارد).</p>
                    </div>
                    <div class="bg-white border p-4 rounded-lg shadow-sm">
                        <div class="font-bold text-red-600 mb-2">۲. حذف صفرها</div>
                        <p class="text-sm text-gray-600">در آزمون علامت، داده‌های برابر با مقدار مرجع را حذف کنید.</p>
                    </div>
                    <div class="bg-white border p-4 rounded-lg shadow-sm">
                        <div class="font-bold text-green-600 mb-2">۳. رتبه میانگین</div>
                        <p class="text-sm text-gray-600">برای داده‌های تکراری (Grounded)، از میانگین رتبه‌ها استفاده کنید.</p>
                    </div>
                    <div class="bg-white border p-4 rounded-lg shadow-sm">
                        <div class="font-bold text-purple-600 mb-2">۴. نوع آزمون</div>
                        <p class="text-sm text-gray-600">کلمات "بهبود/افزایش" (یک‌طرفه) و "تفاوت/تغییر" (دوطرفه) را دریابید.</p>
                    </div>
                </div>
            </section>

            <!-- فوتر محتوا -->
            <div class="text-center text-gray-400 text-sm mt-12 pb-8">
                <p>نسخه نهایی و جامع - ۲۰۲۶</p>
                <p>این جزوه شامل تمام محتویات متنی و محاسباتی تصاویر و پیام‌های ارسالی است.</p>
            </div>

        </div>
    </main>

    <!-- دکمه چت بات -->
    <div id="chat-toggle" class="fixed bottom-6 left-6 bg-blue-600 text-white p-4 rounded-full shadow-lg cursor-pointer hover:bg-blue-700 transition-all z-50 flex items-center gap-2">
        <i class="fas fa-robot text-xl"></i>
        <span class="font-bold">دستیار هوشمند</span>
    </div>

    <!-- پنجره چت -->
    <div id="chat-widget">
        <div class="chat-header">
            <span class="font-bold"><i class="fas fa-robot ml-2"></i>دستیار آماری</span>
            <button onclick="toggleChat()" class="text-white hover:text-gray-200"><i class="fas fa-times"></i></button>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="message bot">
                سلام! من دستیار هوشمند شما هستم. سوالی درباره آزمون‌های علامت، ویلکاکسون یا تحلیل داده‌های جفتی دارید؟
            </div>
        </div>
        <div class="p-3 border-t bg-white flex gap-2">
            <input type="text" id="chat-input" class="flex-1 border rounded-full px-4 py-2 focus:outline-none focus:border-blue-500 text-sm" placeholder="سوال خود را بپرسید...">
            <button onclick="handleChat()" class="bg-blue-600 text-white w-10 h-10 rounded-full hover:bg-blue-700 transition"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <!-- دکمه بازگشت به بالا -->
    <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-20 right-6 bg-gray-800 text-white w-10 h-10 rounded-full shadow-lg hover:bg-gray-700 transition z-40 hidden" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // اسکریپت‌های UI
        const backToTop = document.getElementById('backToTop');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) backToTop.classList.remove('hidden');
            else backToTop.classList.add('hidden');
        });

        // اسکریپت‌های سایدبار
        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('.sidebar-link');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').includes(current)) {
                    link.classList.add('active');
                }
            });
        });

        // اسکریپت‌های چت‌بات
        const chatWidget = document.getElementById('chat-widget');
        const chatToggle = document.getElementById('chat-toggle');
        const chatInput = document.getElementById('chat-input');
        const chatMessages = document.getElementById('chat-messages');

        function toggleChat() {
            if (chatWidget.style.display === 'flex') {
                chatWidget.style.display = 'none';
                chatToggle.style.display = 'flex';
            } else {
                chatWidget.style.display = 'flex';
                chatToggle.style.display = 'none';
            }
        }

        chatToggle.addEventListener('click', toggleChat);
        chatInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') handleChat(); });

        function addMessage(text, sender) {
            const div = document.createElement('div');
            div.className = `message ${sender}`;
            div.innerHTML = text;
            chatMessages.appendChild(div);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleChat() {
            const text = chatInput.value.trim();
            if (!text) return;
            
            addMessage(text, 'user');
            chatInput.value = '';

            setTimeout(() => {
                let response = "متوجه نشدم. لطفاً درباره آزمون‌های علامت یا ویلکاکسون سوال بپرسید.";
                
                if (text.includes("علامت") || text.includes("sign")) {
                    response = "آزمون علامت (Sign Test) ساده‌ترین آزمون ناپارامتری است که فقط به جهت تغییر (+ یا -) توجه می‌کند. اگر تعداد نمونه کم باشد از جدول دوجمله‌ای استفاده می‌شود.";
                } else if (text.includes("ویلکاکسون") && text.includes("مستقل")) {
                    response = "در آزمون ویلکاکسون مستقل، هدف مقایسه مکان دو جامعه مستقل است. آمار W مجموع رتبه‌های یکی از گروه‌هاست.";
                } else if (text.includes("جفتی") || text.includes("paired")) {
                    response = "در داده‌های جفتی (مانند قبل و بعد)، اختلاف‌ها را حساب کرده و رتبه‌بندی می‌کنیم. صفرهای اختلاف حذف می‌شوند.";
                } else if (text.includes("فرمول") || text.includes("تقریب")) {
                    response = "فرمول تقریب نرمال: Z = (W - E(W)) / sqrt(Var(W)). دقت کنید اگر داده‌ها پیوسته باشند از تصحیح پیوستگی (0.5±) استفاده می‌کنیم.";
                } else if (text.includes("صفر") || text.includes("حذف")) {
                    response = "بله، در هر دو آزمون علامت و ویلکاکسون، اگر اختلاف صفر باشد (یا داده برابر میانه فرضی باشد)، آن مشاهده از تحلیل حذف شده و n کاهش می‌یابد.";
                }

                addMessage(response, 'bot');
            }, 800);
        }
    </script>
</body>
</html>